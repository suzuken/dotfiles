<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>プロパティの値の設定および取得</title>

 </head>
 <body><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="sdo.examples-basic.html">基本的な使用法</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="sdo.sample.sequence.html">シーケンスデータオブジェクトの使用</a></div>
 <div class="up"><a href="sdo.examples.html">例</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="sdo.sample.getset" class="section">
  <h2 class="title">プロパティの値の設定および取得</h2>
  <p class="para">
   以下の例では、上で示したスキーマおよびインスタンスドキュメントをもとに
   作成したデータオブジェクトツリーのルート要素が
   <strong class="command">$company</strong> に入っているものとして考えます。
  </p>
  <p class="para">
   <div class="example" id="example-4500">
    <p><b>例1 プロパティ名を使用したアクセス</b></p>
    <div class="example-contents"><p>
     データオブジェクトのプロパティへは、通常のオブジェクトの
     プロパティにアクセスするのと同じ構文でアクセス可能です。
     以下の例では、会社の名前を &#039;Acme&#039; に変更します。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Acme'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-4501">
    <p><b>例2 配列のインデックスを使用したプロパティへのアクセス</b></p>
    <div class="example-contents"><p>
     連想配列形式の構文を使用して、プロパティにアクセスすることもできます。
     最も簡単な負尾法は、プロパティ名を配列のインデックスとして使用する方法です。
     例えば、以下の例では会社の名前を設定してから「今月の従業員」を取得しています。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$company</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'UltraCorp'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$eotm&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">'employeeOfTheMonth'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-4502">
    <p><b>例3 データオブジェクトの繰り返し処理</b></p>
    <div class="example-contents"><p>
     <a href="control-structures.foreach.html" class="link">foreach</a> を使用することにより、データオブジェクトのプロパティを
     順に処理していくことができます。以下の例では、
     今月の従業員のプロパティを順に処理します。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;$eotm&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">employeeOfTheMonth</span><span style="color: #007700">;<br />&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$eotm&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$name</span><span style="color: #DD0000">:&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p> 
     出力は以下のようになります。
    </p></div>     
    <div class="example-contents">
<div class="cdata"><pre>
name: Jane Doe
SN: E0003
</pre></div>
    </div>

    <div class="example-contents"><p> 
     &#039;manager&#039; プロパティは表示されません。なぜなら設定されていないからです。
    </p></div>
   </div>
  </p>
  
  <p class="para">
   <div class="example" id="example-4503">
    <p><b>例4 多くの値をとりうるプロパティへの名前によるアクセス</b></p>
    <div class="example-contents"><p>
     多くの値をとりうるデータオブジェクトのプロパティへのアクセスも、
     オブジェクトのプロパティに対するアクセス構文でアクセスできます。
     例えば部署の一覧を取得するにはこのようにします。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$departments&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">departments</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  
  <p class="para">
   <div class="example" id="example-4504">
    <p><b>例5 多くの値をとりうる要素へのアクセス</b></p>
    <div class="example-contents"><p>
     配列の構文を使用することで、多くの値をとりうる要素における
     個々の要素にアクセスすることが可能です。以下の例では、
     会社の中の最初の部署にアクセスしています。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$ad_tech_dept&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">departments</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-4505">
    <p><b>例6 多くの値をとりうるプロパティの順次処理</b></p>
    <div class="example-contents"><p>
     <a href="control-structures.foreach.html" class="link">foreach</a> を使用して、多くの値をとりうるプロパティを順に処理することができます。
     会社の各部門を順に処理するにはこのようにします。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;</span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">departments&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$department</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...<br />&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     繰り返しのたびに、次の部署が変数
     <strong class="command">$department</strong> に代入されます。
    </p></div>
   </div>
  </p>

  <p class="para">
   <div class="example" id="example-4506">
    <p><b>例7 連結されたプロパティへのアクセス</b></p>
    <div class="example-contents"><p>
     プロパティへの参照を、ひとつの行に連結することができます。
     以下の例では、最初の部署の名前を設定し、取得しています。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">departments</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Emerging&nbsp;Technologies'</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$dept_name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">departments</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>同じことを連想配列構文で行うと、このようになります。</p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;$company</span><span style="color: #007700">[</span><span style="color: #DD0000">'departments'</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">][</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'Emerging&nbsp;Technologies'</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$dept_name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">'departments'</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">][</span><span style="color: #DD0000">'name'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     どちらの場合でも、dept_name の内容は &#039;Emerging Technologies&#039;
     となります。
    </p></div>
   </div>
  </p>

  <p class="para">
   <div class="example" id="example-4507">
    <p><b>例8 XPath によるナビゲーション</b></p>
    <div class="example-contents"><p>
     連想配列のインデックスとして、XPath 風の式を使用することができます。
     実際に使用できる式は、XPath の拡大サブセットです。
    </p></div>
    <div class="example-contents"><p>
     多くの値をとりうるプロパティの表す方法として、
     2 通りの方法がサポートされています。
     最初の方法は、1 から始まる標準的な XPath の配列構文を使用するものです。
     もうひとつは、SDO で XPath を拡張した構文で、
     ゼロから始まるインデックスを使用します。
     標準的な構文は以下のようになります。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;$jane_doe&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">"departments[1]/employees[2]"</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>
    
    <div class="example-contents"><p>そして SDO の拡張版 XPath 構文はこのようになります。</p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;$jane_doe&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">"departments.0/employees.1"</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     どちらの例でも、最初の部署の 2 番目の従業員を取得します。
    </p></div>
   </div>
  </p>

  <p class="para">
   <div class="example" id="example-4508">
    <p><b>例9 XPath による問い合わせ</b></p>
    <div class="example-contents"><p>
     XPath を使用して、インスタンスのデータ内のデータオブジェクトを
     検索することができます。以下の例では、部署
     &#039;Advanced Technologies&#039; の manager を取得しています。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;$ad_tech_mgr&nbsp;</span><span style="color: #007700">=&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">"departments[name='Advanced&nbsp;Technologies']/employees[manager=true]"</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-4509">
    <p><b>例10 子オブジェクトの作成</b></p>
    <div class="example-contents"><p>
     データオブジェクトは、自分自身の中に子オブジェクトを保持することが
     できます。子データオブジェクトは自動的にデータグラフの一員となります。
     以下の例では、部署 &#039;Advanced Technologies&#039; に新しい従業員を追加しています。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;$ad_tech_dept&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">"departments[name='Advanced&nbsp;Technologies']"</span><span style="color: #007700">];<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$new_hire&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$ad_tech_dept</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createDataObject</span><span style="color: #007700">(</span><span style="color: #DD0000">'employees'</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$new_hire</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'John&nbsp;Johnson'</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$new_hire</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">SN&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'E0005'</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$new_hire</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">manager&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-4510">
    <p><b>例11 プリミティブなプロパティの開放</b></p>
    <div class="example-contents"><p>
     データオブジェクトに項目が登録されているかどうかを確かめたり
     項目を削除したりする際には、それぞれ <span class="function"><a href="function.isset.html" class="function">isset()</a></span>
     および <span class="function"><a href="function.unset.html" class="function">unset()</a></span> 関数が使用可能です。
    </p></div>
    <div class="example-contents"><p>
     以下の例は、最初の部署の名前を消去します。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;</span><span style="color: #007700">unset(</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">departments</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  </p>
     
  <p class="para">
   <div class="example" id="example-4511">
    <p><b>例12 データオブジェクトの開放</b></p>
    <div class="example-contents"><p>
     unset は、ツリーからデータオブジェクトを削除する場合にも使用できます。
     以下の例は、John Jones を会社から削除します。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;</span><span style="color: #007700">unset(</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">departments</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">employees</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  
  <p class="para">
   <div class="example" id="example-4512">
    <p><b>例13 参照されているデータオブジェクトの開放</b></p>
    <div class="example-contents"><p>
     以下の例では、会社から「今月の従業員」を削除します。
     もしこれらの間に包含関係があった場合、参照先の従業員も
     削除されてしまいます (その月の一番優秀な従業員を毎月クビにしていく
     なんてバカなことは、普通はしないでしょう!)。
     しかし実際にはこれらは包含関係ではないので、参照先の
     従業員は会社の中の部署の中に残り続けます。ただ、
     employeeOfTheMonth プロパティを通じてはアクセスできなくなります。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">employeeOfTheMonth</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;unset(</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">employeeOfTheMonth</span><span style="color: #007700">);<br />&nbsp;&nbsp;}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  
  <p class="para">
   <div class="example" id="example-4513">
    <p><b>例14 プロパティのインデックスを使用したアクセス</b></p>
    <div class="example-contents"><p>
     配列構文を使用して、プロパティのインデックス経由で
     データオブジェクトのプロパティにアクセスすることができます。
     プロパティのインデックスは、モデル (この場合は xml スキーマ)
     内でそのプロパティの定義が現れる位置となります。
     上のスキーマの例では、会社の名前が company の
     2 番目の属性であることがわかります (SDO のインターフェイスは、
     XML の要素と属性を区別しません)。以下の例では、
     会社の名前を &#039;Acme&#039; に設定します。これは
     <a href="sdo.sample.getset.html#sdo.examples.propname" class="link">プロパティ名を使用したアクセス</a>
     と同じ結果となります。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;$company</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'Acme'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     このようにインデックスを直接使用すると、後で破綻してしまう可能性があります。
     通常はプロパティ名を使用する方式を推奨します。
     しかし、時にはインデックスによるアクセスが必要になる場合もあるでしょう。
    </p></div>
   </div>
  </p>

 </div><hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="sdo.examples-basic.html">基本的な使用法</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="sdo.sample.sequence.html">シーケンスデータオブジェクトの使用</a></div>
 <div class="up"><a href="sdo.examples.html">例</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
